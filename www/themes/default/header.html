<!DOCTYPE html>
<html lang="ru">

<head>
	<title>{TITLE}</title>
	<meta name="description" content="{META_DESRIPTION}" />
	<meta name="keywords" content="{META_KEYWORDS}" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
	{INSERT_HEADER}
<!-- IF_LOCALHOST_SERVER_BEGIN -->
	<link href="{THEME_URL}semantic.min.css" rel="stylesheet" type="text/css" />
	<script type="text/javascript" src="{THEME_URL}js/jquery.min.js"></script>
	<script type="text/javascript" src="{THEME_URL}js/semantic.min.js"></script>
<!-- IF_LOCALHOST_SERVER_ELSE -->
    <link href="https://cdn.jsdelivr.net/npm/fomantic-ui/dist/semantic.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/fomantic-ui/dist/semantic.min.js"></script>
<!-- IF_LOCALHOST_SERVER_END -->
	<link href="{THEME_URL}style.css" rel="stylesheet" type="text/css" />
	<script>
		$(document).ready(function () {
			// Инициализация стандартныx компонентов Fomantic-UI
			$('.ui.checkbox').checkbox();
			$('.ui.icon.button').popup();
			$('.ui.dropdown').dropdown();
			$('.ui.sticky').sticky({ context: '#short_menu' });
			console.log('Initializing readonly ratings...');

			function initializeReadOnlyRating() {
				$('.readonly-rating').each(function () {
					const ratingContainer = $(this);
					const maxRating = parseFloat(ratingContainer.attr('data-max-rating')) || 1;
					const ratingValue = parseFloat(ratingContainer.attr('data-rating')) || 0;

					console.log(`Processing rating: value=${ratingValue}, max=${maxRating}`);

					const totalIcons = 2 * maxRating + 1;

					ratingContainer.empty();
					for (let i = 0; i < totalIcons; i++) {
						ratingContainer.append('<i class="icon"></i>');
					}

					ratingContainer.rating({
						initialRating: Math.abs(ratingValue),
						maxRating: totalIcons,
						interactive: false,
						fireOnInit: true,
						onRate: function () {
							return false;
						}
					});

					ratingContainer.find('.icon').each(function (index) {
						const icon = $(this);
						const midpoint = maxRating;

						if (index < midpoint) {
							icon.addClass('red');
						} else if (index === midpoint) {
							icon.addClass('grey');
						} else {
							icon.addClass('green');
						}
					});

					const fractionalPart = Math.abs(ratingValue) % 1;
					if (fractionalPart > 0) {
						const activeIconIndex = Math.floor(Math.abs(ratingValue));
						const partialIcon = ratingContainer.find('.icon').eq(activeIconIndex);
						partialIcon.addClass('partial');

						const fillPercent = `${fractionalPart * 100}%`;
						partialIcon.css('--fill-percent', fillPercent);
						console.log(`Set --fill-percent to ${fillPercent}`);
					}
				});
			}

			initializeReadOnlyRating();
		});
	</script>
</head>

<body {INSERT_BODY}>
<div align="center">
	<table class="my" width="{GALLERY_WIDHT}" cellspacing="0" cellpadding="0">
		<tr>
           	<td class="header_site">
				<img src="{THEME_URL}images/logo-1.png" alt="{SITE_NAME} - {SITE_DESCRIPTION}" title="{SITE_NAME} - {SITE_DESCRIPTION}" />
			</td>
		</tr>
		<tr>
			<td class="field_small_left">
				<div class="mini ui inverted transparent segment no-space" id="short_menu">
					<div class="mini ui inverted transparent sticky no-space">
						<table cellpadding="0" cellspacing="0" width="100%">
							<tr>
								<td>
<!-- IF_SHORT_MENU_BEGIN -->
									<table cellpadding="0" cellspacing="0" border="0">
										<tr>
											<td>
												<div class="small ui black inverted menu">
<!-- ARRAY_SHORT_MENU_BEGIN -->
<!-- IF_SHORT_MENU_URL_BEGIN -->
													<a class="item custom-menu" href="{U_SHORT_MENU}"  title="{L_SHORT_MENU}">{L_SHORT_MENU}</a>
<!-- IF_SHORT_MENU_URL_ELSE -->
													<a class="item active" title="{L_SHORT_MENU}">{L_SHORT_MENU}</a>
<!-- IF_SHORT_MENU_URL_END -->
<!-- ARRAY_SHORT_MENU_END -->
												</div>
											</td>
										</tr>
									</table>
<!-- IF_SHORT_MENU_ELSE -->
						&nbsp;
<!-- IF_SHORT_MENU_END -->
								</td>
								<td>
									<form name="search" action="{U_SEARCH}" method="post">
										<table align="right" border="0" cellpadding="0" cellspacing="0">
											<tr>
												<td colspan="2"><div class="small ui inverted icon input custom-input"><input class="ui input" type="text" name="search_main_text" placeholder="{L_SEARCH}..." /><i class="search icon"></i></div></td>
												<td><input class="small ui basic inverted button custom-input" name="search" type="submit" value="{L_SEARCH}" title="{L_SEARCH}" /></td>
											</tr>
										</table>
									</form>
								</td>
							</tr>
						</table>
					</div>
				</div>
			</td>
		</tr>
		<tr>
			<td class="field">
				<table cellpadding="0" cellspacing="0" width="100%">
                       	<col width="{LEFT_PANEL_WIDHT}" />
                        <col />
                        <col />
                        <col />
                        <col width="{RIGHT_PANEL_WIDHT}"  />
                	<tr class="td_spacer">
						<td class="td_spacer" width="{LEFT_PANEL_WIDHT}"><img src="{THEME_URL}images/spacer.gif" height="1" border="0" alt="" width="{LEFT_PANEL_WIDHT}" /></td>
						<td class="td_spacer"><img src="{THEME_URL}images/spacer.gif" height="1" border="0" alt="" width="1" /></td>
						<td class="td_spacer"><img src="{THEME_URL}images/spacer.gif" height="1" border="0" alt="" width="1" /></td>
						<td class="td_spacer"><img src="{THEME_URL}images/spacer.gif" height="1" border="0" alt="" width="1" /></td>
						<td class="td_spacer" width="{RIGHT_PANEL_WIDHT}"><img src="{THEME_URL}images/spacer.gif" height="1" border="0" alt="" width="{RIGHT_PANEL_WIDHT}" /></td>
					</tr>
					<tr>
						<td class="field">
<!-- ARRAY_LEFT_PANEL_BEGIN -->
<!-- SELECT_LEFT_BLOCK_BEGIN -->
<!-- CASE_MENU -->
							<table cellpadding="0" cellspacing="0" border="0" width="100%" class="field_small">
								<tr>
									<td>
                                        <div class="large ui top black attached segment" style="border-radius: 15px 15px 0 0;">
                                            <div class="large ui top black attached centered label">
                                                <i class="bars icon"></i> {LONG_MENU_NAME_BLOCK}
                                            </div>
                                        </div>
                                    </td>
								</tr>
<!-- IF_LONG_MENU_BEGIN -->
								<tr>
									<td>
										<div class="ui buttons vertical" style="width:100%;">
<!-- ARRAY_LONG_MENU_BEGIN -->
<!-- IF_LONG_MENU_URL_BEGIN -->
											<button style="width:100%; text-align: left;" class="small ui inverted button" onclick="window.location.href='{U_LONG_MENU}'" title="{L_LONG_MENU}"><i class="folder outline icon"></i> {L_LONG_MENU}</button><br />
<!-- IF_LONG_MENU_URL_ELSE -->
											<button style="width:100%; text-align: left;" class="small ui secondary active button" title="{L_LONG_MENU}"><i class="folder open outline icon"></i> {L_LONG_MENU}</button><br />
<!-- IF_LONG_MENU_URL_END -->
<!-- ARRAY_LONG_MENU_END -->
										</div>
									</td>
								</tr>
<!-- IF_LONG_MENU_END -->
							</table>
<!-- BREAK_MENU -->
<!-- CASE_TOP_LAST_PHOTO -->
							<table cellpadding="0" cellspacing="0" border="0" width="100%" class="field_small">
								<tr>
									<td>
                                        <div class="large ui top black attached segment" style="border-radius: 15px 15px 0 0;">
                                            <div class="large ui top black attached centered label">
                                                <i class="camera retro icon"></i> {NAME_BLOCK}
                                            </div>
                                        </div>
									</td>
								</tr>
								<tr>
									<td class="mini_photo"><a href="{U_CATEGORY}" title="{D_DESCRIPTION_CATEGORY}">{D_NAME_CATEGORY}</a> -&gt; <a href="{U_PHOTO}" title="{D_DESCRIPTION_PHOTO}">{D_NAME_PHOTO}</a></td>
								</tr>
								<tr>
									<td class="mini_photo"><a href="{U_PHOTO}" title="{D_DESCRIPTION_PHOTO}"><img src="{U_THUMBNAIL_PHOTO}" alt="{D_NAME_PHOTO}" width="{PHOTO_WIDTH}" height="{PHOTO_HEIGHT}" title="{D_DESCRIPTION_PHOTO}" border="0" /></a></td>
								</tr>
								<tr>
									<td class="mini_photo">
<!-- IF_USER_EXISTS_BEGIN -->
										{L_USER_ADD}: <a href="{U_PROFILE_USER_ADD}" title="{D_REAL_NAME_USER_ADD}">{D_REAL_NAME_USER_ADD}</a>.
<!-- IF_USER_EXISTS_ELSE -->
										{D_REAL_NAME_USER_ADD}
<!-- IF_USER_EXISTS_END -->
									</td>
								</tr>
								<tr>
									<td class="mini_photo">{PHOTO_RATE}</td>
								</tr>
							</table>
<!-- BREAK_TOP_LAST_PHOTO -->
<!-- CASE_DEFAULT -->
							<table cellpadding="0" cellspacing="0" border="0" width="100%" class="field_small">
								<tr>
                                    <td>
                                        <div class="ui top black attached segment" style="border-radius: 15px 15px 0 0;">
                                            <div class="ui top black attached centered label">
                                                <i class="exclamation circle icon"></i> ERROR CASE_BLOCK <i class="bug icon"></i>
                                            </div>
                                        </div>
                                    </td>
								</tr>
							</table>
<!-- BREAK_DEFAULT -->
<!-- SELECT_LEFT_BLOCK_END -->
<!-- ARRAY_LEFT_PANEL_END -->
						</td>
						<td width="5px" class="td_spacer">&nbsp;</td>
						<td class="field">
